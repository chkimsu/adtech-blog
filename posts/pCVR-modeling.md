## 1. pCVR 모델링이 pCTR과 다른 점 (Precautions)
pCTR 모델링 경험을 바탕으로 pCVR로 확장할 때 직면하는 주요 챌린지들을 정리함.

### ① 샘플 선택 편향 (Sample Selection Bias, SSB)
- **현상:** 모델은 '클릭된 데이터'만 학습하지만, 실제 서빙 시에는 '전체 노출' 컨텍스트에서 예측을 수행해야 함.
- **해결:** **ESMM(Entire Space Multi-Task Model)** 구조를 도입하여 $P(z=1|y=1, x)$가 아닌 전체 공간에서 $P(y=1, z=1|x)$를 학습하도록 유도하는 것이 정석임.

### ② 데이터 희소성 (Data Sparsity)
- **현상:** Click 대비 Conversion은 발생 빈도가 현저히 낮아 양성 샘플(Positive Sample) 확보가 어려움.
- **해결:** CTR 태스크와의 **Multi-task Learning**을 통해 로우 레벨 임베딩 층을 공유하거나, 사전 학습된 CTR 모델의 가중치를 Transfer 하는 방식이 유효함.

### ③ 지연된 피드백 (Delayed Feedback)
- **현상:** 클릭은 즉각적이나 전환은 며칠 뒤에도 발생함. 학습 시점에 미전환된 데이터를 단순 Negative로 처리하면 노이즈가 됨.
  - **해결:** 적절한 **Attribution Window** 설정이 필수이며, 윈도우 내 미전환 데이터를 처리하는 알고리즘적 보정 검토가 필요함.

### ④ Last Click Attribution의 한계 
- 현재 실무에서 많이 쓰는 Last Click 방식은 구매 직전의 매체에만 기여도를 몰아주는 경향이 있음. 모델이 특정 시점의 광고만 과대평가하지 않도록 비즈니스 로직에 따른 라벨링 검증이 중요함.

---

## 2. 중복 전환 (Duplicated Conversion) 이슈와 대응
데이터 파이프라인 및 모델의 신뢰도를 저해하는 '중복 전환' 문제를 심층 분석함.

### ① 중복 발생 원인
- **기술적 요인:** 사용자 페이지 새로고침, 뒤로 가기 액션, 중복 설치된 트래킹 태그 등.
- **비즈니스 요인:** 여러 광고 채널을 거쳐 들어온 유저에 대해 각 플랫폼이 독자적으로 전환을 집계할 때 발생.

### ② 모델에 미치는 영향
- **라벨 노이즈:** 동일 액션이 중복 학습되어 특정 피처에 과도한 가중치가 부여됨.
- **예측값 왜곡:** 실제 확률보다 pCVR이 높게 튀어 비딩 로직에서 오버비딩(Over-bidding) 유발 및 광고주 ROAS 저하.

### ③ 실무적 해결 방안 (Deduplication)
- **Transaction ID (Order ID) 활용:** 결제 고유 번호를 Key로 잡아 파이프라인 상단에서 중복을 제거함 (가장 권장됨).
- **Click ID 기반 1:1 매핑:** 클릭 시 부여한 고유 ID를 전환 시점에 매칭하여 유일성을 보장함.
- **Time-window 기반 필터링:** 동일 유저가 단시간 내 동일 상품에 발생시킨 전환을 하나로 합침.

---

## 3. 개인적인 인사이트 (Summary)
pCVR은 모델의 아키텍처 개선만큼이나 **'얼마나 깨끗하고 편향 없는 정답지(Label)를 구축하느냐'**라는 데이터 엔지니어링 측면의 완성도가 성능을 좌우함. 특히 중복 제거 로직은 모델 학습 전 단계인 데이터 전처리 파이프라인에서 완결성을 가져야 함.
